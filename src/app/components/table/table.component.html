

<div class="table-section">
  <p-table
    #dt2
    [value]="incidents"
    [paginator]="true"
    [first]="first"
    [showCurrentPageReport]="true"
    [(selection)]="selectedIncidents"
    [rows]="5"
    [rowsPerPageOptions]="[5,10, 25, 50]"
    [paginator]="true"
    sortMode="multiple"
    [globalFilterFields]="['title','incidentId','categoryId']"
    [tableStyle]="{ 'min-width': '50rem' }"
    currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
    (onPage)="pageChange($event)"
  >
  <ng-template pTemplate="caption">
    <div class="flex">
      <i class="bi bi-eraser" (click)="clear(dt2)"></i>
        <span class="p-input-icon-left ml-auto">
            <i class="pi pi-search"></i>
            <input class="search" pInputText type="text" [(ngModel)]="searchValue" (input)="filterGlobal($event)" placeholder="Search keyword" />
        </span>
    </div>
  </ng-template>
    <ng-template pTemplate="header">
        <tr>
          <th style="width: 4rem">
            <p-tableHeaderCheckbox />
        </th>
            <th style="width:12%" pSortableColumn="incidentId">
              <div class="flex align-items-center">
                <p-sortIcon field="incidentId" />ID
                <p-columnFilter type="text" field="incidentId" display="menu" />
              </div>
            </th>

            <th style="width:20%">
              <div class="flex align-items-center">
                  Title
                  <p-columnFilter type="text" field="title" display="menu" />
              </div>
            </th>

            <th style="width:10%">
              <div class="flex align-items-center">
                  Type
                  <p-columnFilter type="text" field="incidentType" display="menu" />
              </div>
              </th>
              <th style="width:13%">
              <div class="flex align-items-center">
                  Categories
                  <p-columnFilter type="text" field="category_id" display="menu" />
              </div>
              </th>
            <th style="width:15%">Reported By
              <p-columnFilter type="text" field="type" display="menu" />
            </th>
            <th style="width:10%" class="column-visible">
              <div class="flex align-items-center ">
                  Priority
                  <p-columnFilter field="priority" display="menu">
                    <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                        <p-dropdown
                            [options]="priorities"
                            [(ngModel)]="priorityValue"
                            (onChange)="filter($event.value)"
                            placeholder="Select Priority">
                        </p-dropdown>
                    </ng-template>
                </p-columnFilter>
              </div>
              </th>
              <th style="width:10%">
                <div class="flex align-items-center">
                    Status
                    <p-columnFilter type="text" field="status" display="menu" />
                </div>
                </th>
            <th style="width:15%">Action</th>
        </tr>
    </ng-template>
    <ng-template pTemplate="body" let-incident>
        <tr>
            <td>
            <p-tableCheckbox [value]="incident" />
            </td>
            <td>{{ incident.incidentId }}</td>
            <td>{{ incident.title }}</td>
            <td>{{ incident.incidentType}}</td>
            <td>{{ incident.categoryId }}</td>
            <td>{{ incident.reportedBy }}</td>
            <td>{{ incident.priority}}</td>
            <td>{{ incident.status }}</td>
            <td>
              <div class="flex justify-content-center">
               <i class="bi bi-three-dots-vertical" (click)="op.toggle($event)"></i>
               <p-overlayPanel #op>
                <div class="custom-overlay">
                  <ul class="list-none p-0 m-0 flex flex-column gap-3 custom-list">
                    <li class="flex align-items-center gap-2 custom-item">
                      <i class="bi bi-pencil-square"> </i>Edit
                    </li>
                    <li class="flex align-items-center gap-2 custom-item">
                      <i class="bi bi-eye"></i>View
                    </li>
                  </ul>
                </div>
              </p-overlayPanel>

                <i class="bi bi-send" (click)="openForwardingModal(incident.incidentId)"></i>
            </div>



     </td>
        </tr>
    </ng-template>
    <ng-template pTemplate="paginatorleft">
        <p-button type="button" icon="pi pi-plus" styleClass="p-button-text" />
    </ng-template>
    <ng-template pTemplate="paginatorright">
        <p-button type="button" icon="pi pi-cloud" styleClass="p-button-text" />
    </ng-template>
  </p-table>
  </div>

  <p-dialog header="Forward Incident" [(visible)]="displayForwardingModal" [modal]="true" [style]="{width: '50vw'}">

  </p-dialog>

